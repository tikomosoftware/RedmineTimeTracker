<Window x:Class="redmineSupTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{DynamicResource AppTitle}" Height="800" Width="1000"
        MinWidth="800" MinHeight="600"
        WindowStartupLocation="CenterScreen">
    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="{DynamicResource MenuSettings}">
                <MenuItem Header="{DynamicResource MenuConnectionSettings}" Click="SettingsMenuItem_Click"/>
            </MenuItem>
            <MenuItem Header="{DynamicResource MenuView}">
                <MenuItem x:Name="ToggleLogMenuItem" Header="{DynamicResource MenuShowLog}" 
                          IsCheckable="True" IsChecked="False"
                          Click="ToggleLogMenuItem_Click"/>
            </MenuItem>
            <MenuItem Header="{DynamicResource MenuHelp}">
                <MenuItem Header="{DynamicResource MenuUserGuide}" Click="UserGuideMenuItem_Click"/>
                <MenuItem Header="{DynamicResource MenuReadme}" Click="ReadmeMenuItem_Click"/>
                <Separator/>
                <MenuItem Header="{DynamicResource MenuAbout}" Click="AboutMenuItem_Click"/>
            </MenuItem>
        </Menu>
        
        <Grid Background="#F5F5F7" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition x:Name="SplitterColumn" Width="0"/>
                <ColumnDefinition x:Name="LogColumn" Width="0"/>
            </Grid.ColumnDefinitions>
            
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="2*" MinHeight="80"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="5*" MinHeight="150"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBlock Text="{DynamicResource LabelTargetMonth}" VerticalAlignment="Center" Margin="0,0,10,0" FontSize="14"/>
                    <ComboBox x:Name="MonthSelector" Width="150" Height="30" VerticalAlignment="Center"/>
                    <Button x:Name="RefreshButton" Content="{DynamicResource BtnRefresh}" Margin="10,0,0,0" 
                            Padding="10,5" Click="RefreshButton_Click"
                            Background="White" BorderBrush="#CCCCCC" BorderThickness="1"/>
                    <TextBlock x:Name="StatusTextBlock" Text="{DynamicResource StatusReady}" 
                               VerticalAlignment="Center" Margin="20,0,0,0" 
                               FontSize="12" Foreground="#666666"/>
                </StackPanel>
                
                <Border Grid.Row="1" Background="White" BorderBrush="#CCCCCC" 
                        BorderThickness="1" CornerRadius="4" Margin="0,0,0,10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <Border Grid.Row="0" Background="#F0F0F0" Padding="10">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{DynamicResource LabelWorkTemplates}" FontSize="16" 
                                           FontWeight="Bold" VerticalAlignment="Center"/>
                                <Button x:Name="AddTemplateButton" Content="{DynamicResource BtnAddTemplate}" 
                                        Margin="20,0,0,0" Padding="15,5"
                                        Click="AddTemplateButton_Click"
                                        Background="#007BFF" Foreground="White" BorderThickness="0"/>
                            </StackPanel>
                        </Border>
                        
                        <DataGrid Grid.Row="1" x:Name="TemplateGrid" 
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False">
                            <DataGrid.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                    <Setter Property="Height" Value="32"/>
                                </Style>
                            </DataGrid.CellStyle>
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn Header="" Width="40" 
                                                        Binding="{Binding IsEnabled, UpdateSourceTrigger=PropertyChanged}">
                                    <DataGridCheckBoxColumn.ElementStyle>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridCheckBoxColumn.ElementStyle>
                                </DataGridCheckBoxColumn>
                                <DataGridTextColumn Header="{DynamicResource HeaderName}" Width="150" 
                                                    Binding="{Binding Name}" IsReadOnly="True"/>
                                <DataGridTextColumn Header="{DynamicResource HeaderIssueId}" Width="100" 
                                                    Binding="{Binding IssueId}" IsReadOnly="True"/>
                                <DataGridTextColumn Header="{DynamicResource HeaderHours}" Width="80" 
                                                    Binding="{Binding DefaultHours}" IsReadOnly="True"/>
                                <DataGridTextColumn Header="{DynamicResource HeaderActivity}" Width="120" 
                                            Binding="{Binding ActivityName}" IsReadOnly="True"/>
                                <DataGridTextColumn Header="{DynamicResource HeaderFrequency}" Width="*" 
                                            Binding="{Binding FrequencyDisplay}" IsReadOnly="True"/>
                                <DataGridTemplateColumn Header="{DynamicResource HeaderAction}" Width="Auto">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="{DynamicResource BtnEdit}" Margin="2" Padding="8,2" Click="EditTemplateButton_Click"
                                                        Background="#F8F9FA" BorderBrush="#DDDDDD" BorderThickness="1"/>
                                                <Button Content="{DynamicResource BtnDelete}" Margin="2" Padding="8,2" Click="DeleteTemplateButton_Click" 
                                                        Background="#FFEBEE" Foreground="#D32F2F" BorderBrush="#FFCDD2" BorderThickness="1"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
                
                <GridSplitter Grid.Row="2" Height="5" 
                              HorizontalAlignment="Stretch" 
                              VerticalAlignment="Center"
                              Background="#CCCCCC" 
                              Cursor="SizeNS"
                              Margin="0,3"/>
                
                <Border Grid.Row="3" Background="White" BorderBrush="#CCCCCC" 
                        BorderThickness="1" CornerRadius="4" Margin="0,0,0,10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <Border Grid.Row="0" Background="#F0F0F0" Padding="10">
                            <Grid>
                                <TextBlock x:Name="CalendarTitle" Text="2026年2月" 
                                           FontSize="16" FontWeight="Bold" HorizontalAlignment="Left"/>
                                <TextBlock x:Name="TotalHoursTextBlock" Text="合計: 0.0h" 
                                           FontSize="16" FontWeight="Bold" HorizontalAlignment="Right" Foreground="#28A745"/>
                            </Grid>
                        </Border>
                        
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <StackPanel x:Name="CalendarPanel" Margin="10"/>
                        </ScrollViewer>
                    </Grid>
                </Border>
                
                <StackPanel Grid.Row="4" Orientation="Horizontal" 
                            HorizontalAlignment="Center">
                    <Button x:Name="BulkRegisterButton" Content="{DynamicResource BtnBulkRegister}" 
                            Padding="30,10" FontSize="14" Margin="0,0,10,0"
                            Background="#28A745" Foreground="White" 
                            BorderThickness="0"
                            Click="BulkRegisterButton_Click"/>
                    <Button x:Name="PreviewButton" Content="{DynamicResource BtnPreview}" 
                            Padding="20,10" FontSize="14"
                            Click="PreviewButton_Click"
                            Background="#6C757D" Foreground="White" BorderThickness="0"/>
                </StackPanel>
            </Grid>
            
            <!-- GridSplitter for resizing log panel -->
            <GridSplitter x:Name="LogSplitter" Grid.Column="1" 
                          Width="5" 
                          HorizontalAlignment="Stretch" 
                          VerticalAlignment="Stretch"
                          Background="#CCCCCC"
                          Visibility="Collapsed"/>
            
            <!-- Log Panel -->
            <Border x:Name="LogPanel" Grid.Column="2" Background="White" 
                    BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="4" 
                    Margin="10,0,0,0" Visibility="Collapsed">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <Border Grid.Row="0" Background="#F0F0F0" Padding="10">
                        <TextBlock Text="{DynamicResource LabelLog}" FontSize="14" FontWeight="Bold"/>
                    </Border>
                    
                    <TextBox Grid.Row="1" x:Name="LogTextBox" 
                             IsReadOnly="True"
                             VerticalScrollBarVisibility="Auto"
                             HorizontalScrollBarVisibility="Auto"
                             FontFamily="Meiryo, MS Gothic"
                             FontSize="12"
                             TextWrapping="Wrap"
                             Margin="5"/>
                    
                    <Button Grid.Row="2" Content="{DynamicResource BtnClearLog}" Margin="5" Padding="10,5"
                            HorizontalAlignment="Right"
                            Click="ClearLogButton_Click"/>
                </Grid>
            </Border>
        </Grid>
    </DockPanel>
</Window>
